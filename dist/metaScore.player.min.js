/*! metaScore - v0.0.2 - 2015-01-16 - Oussama Mubarak */
(function(t){"use strict";var e=t.metaScore;Element&&function(t){t.matches=t.matchesSelector=t.matchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||function(t){for(var e=(this.parentNode||this.document).querySelectorAll(t),n=-1;e[++n]&&e[n]!==this;);return!!e[n]}}(Element.prototype),function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;e.length>n&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var n=(new Date).getTime(),o=Math.max(0,16-(n-t)),i=window.setTimeout(function(){e(n+o)},o);return t=n+o,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),e=t.metaScore={version:"0.0.2",revision:"cfa6c1",locale:"fr",getVersion:function(){return this.version},getRevision:function(){return this.revision},setLocale:function(t){this.locale=t},getLocale:function(){return this.locale},namespace:function(t){for(var e,n=this,o=t.split("."),i=0,r=o.length;r>i;i++)e=o[i],n[e]=n[e]||{},n=n[e];return n}},e.Class=function(){function t(){}return t.defaults={},t.extend=function(t){t.prototype=Object.create(this.prototype,{constructor:{value:t}}),t.parent=this,t.extend=this.extend,"defaults"in t||(t.defaults={});for(var e in this.defaults)e in t.defaults||(t.defaults[e]=this.defaults[e])},t.prototype.getConfigs=function(t){t=t||{};for(var e in this.constructor.defaults)e in t||(t[e]=this.constructor.defaults[e]);return t},t}(),e.Evented=function(){function t(){t.parent.call(this),this.listeners={}}return e.Class.extend(t),t.prototype.addListener=function(t,e){return this.listeners[t]===void 0&&(this.listeners[t]=[]),this.listeners[t].push(e),this},t.prototype.removeListener=function(t,e){if(this.listeners[t]instanceof Array)for(var n=this.listeners[t],o=0,i=n.length;i>o;o++)if(n[o]===e){n.splice(o,1);break}return this},t.prototype.triggerEvent=function(t,n,o,i){var r,s;return this.listeners[t]instanceof Array&&(r=this.listeners[t],s={target:this,type:t,detail:n,bubbles:o!==!1,cancelable:i!==!1},e.Object.each(r,function(t,e){e.call(this,s)},this)),this},t}(),e.Ajax=function(){function t(){}return e.Class.extend(t),t.createXHR=function(){var t,e,n,o=["MSXML2.XMLHttp.5.0","MSXML2.XMLHttp.4.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp","Microsoft.XMLHttp"];if("undefined"!=typeof XMLHttpRequest)return t=new XMLHttpRequest;if(window.ActiveXObject)for(e=0,n=o.length;n>e;e++)try{return t=new ActiveXObject(o[e])}catch(i){}throw Error("XMLHttp object could be created.")},t.send=function(n,o){var i=t.createXHR(),r={method:"GET",headers:{},async:!0,data:{},dataType:"json",complete:null,success:null,error:null,scope:this};if(o=e.Object.extend({},r,o),!("POST"!==o.method&&"PUT"!==o.method||"Content-type"in o.headers))switch(o.dataType){case"json":o.headers["Content-type"]="application/json;charset=UTF-8";break;default:o.headers["Content-type"]="application/x-www-form-urlencoded"}return i.open(o.method,n,o.async),e.Object.each(o.headers,function(t,e){i.setRequestHeader(t,e)}),i.onreadystatechange=function(){4===i.readyState&&(e.Var.is(o.complete,"function")&&o.complete.call(o.scope,i),i.status>=200&&300>i.status||304===i.status?e.Var.is(o.success,"function")&&o.success.call(o.scope,i):e.Var.is(o.error,"function")&&o.error.call(o.scope,i))},i.send(o.data),i},t.get=function(n,o){return e.Object.extend(o,{method:"GET"}),t.send(n,o)},t.post=function(n,o){return e.Object.extend(o,{method:"POST"}),t.send(n,o)},t.put=function(n,o){return e.Object.extend(o,{method:"PUT"}),t.send(n,o)},t}(),e.Array=function(){function t(){}return e.Class.extend(t),t.inArray=function(t,e){var n,o=0;if(e){if(e.indexOf)return e.indexOf(t);for(n=e.length;n>o;o++)if(o in e&&e[o]===t)return o}return-1},t.copy=function(t){return[].concat(t)},t.shuffle=function(e){var n=t.copy(e);return n.sort(function(){return(0|3*Math.random())-1}),n},t.unique=function(t){for(var e=[],n=t.length,o=0;n>o;o++){for(var i=o+1;n>i;i++)t[o]===t[i]&&(i=++o);e.push(t[o])}return e},t.each=function(t,e,n){for(var o,i=0,r=t.length,s=void 0!==n;r>i&&(o=e.call(s?n:t[i],i,t[i]),o!==!1);i++);return t},t.remove=function(e,n){for(var o=t.inArray(n,e);o>-1;)e.splice(o,1),o=t.inArray(n,e);return e},t}(),e.Color=function(){function t(){}return e.Class.extend(t),t.rgb2hsv=function(t){var e,n,o,i=t.r,r=t.g,s=t.b,a=Math.max(i,r,s),c=Math.min(i,r,s),l=a-c;if(n=0===a?0:l/a,o=a,a===c)e=0;else{switch(a){case i:e=(r-s)/l+(s>r?6:0);break;case r:e=(s-i)/l+2;break;case s:e=(i-r)/l+4}e/=6}return{h:e,s:n,v:o}},t.parse=function(t){var n,o={};return e.Var.is(t,"object")?(o.r="r"in t?t.r:0,o.g="g"in t?t.g:0,o.b="b"in t?t.b:0,o.a="a"in t?t.a:1):e.Var.is(t,"string")&&(t=t.replace(/\s\s*/g,""),(n=/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})/.exec(t))?(o.r=parseInt(n[1],16),o.g=parseInt(n[2],16),o.b=parseInt(n[3],16),o.a=1):(n=/^#([\da-fA-F])([\da-fA-F])([\da-fA-F])/.exec(t))?(o.r=17*parseInt(n[1],16),o.g=17*parseInt(n[2],16),o.b=17*parseInt(n[3],16),o.a=1):(n=/^rgba\(([\d]+),([\d]+),([\d]+),([\d]+|[\d]*.[\d]+)\)/.exec(t))?(o.r=+n[1],o.g=+n[2],o.b=+n[3],o.a=+n[4]):(n=/^rgb\(([\d]+),([\d]+),([\d]+)\)/.exec(t))&&(o.r=+n[1],o.g=+n[2],o.b=+n[3],o.a=1)),o},t}(),e.Dom=function(){function t(){var t;this.elements=[],arguments.length>0&&((t=e.Dom.elementsFromString.apply(this,arguments))?(this.add(t),arguments.length>1&&this.attr(arguments[1])):(t=e.Dom.selectElements.apply(this,arguments))&&(this.add(t),arguments.length>2&&this.attr(arguments[2])))}return e.Class.extend(t),t.stringRe=/^<(.)+>$/,t.camelRe=/-([\da-z])/gi,t.camelReplaceFn=function(t,e){return e.toUpperCase()},t.camel=function(e){return e.replace(t.camelRe,t.camelReplaceFn)},t.bubbleEvents={click:!0,submit:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseover:!0,mouseout:!0,transitionend:!0},t.selectElement=function(t,n){var o;return n||(n=document),o=e.Var.is(t,"string")?n.querySelector(t):t.length?t[0]:t},t.selectElements=function(n,o){var i;return o?o instanceof t&&(o=o.get(0)):o=document,i=e.Var.is(n,"string")?o.querySelectorAll(n):n.length?n:[n]},t.elementsFromString=function(t){var e,n,o,i={option:[1,"<select multiple='multiple'>","</select>"],optgroup:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tbody:[1,"<table>","</table>"],tfoot:[1,"<table>","</table>"],colgroup:[1,"<table>","</table>"],caption:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],th:[3,"<table><tbody><tr>","</tr></tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[1,"<div>","</div>"]},r=document.createElement("div"),s=/<\s*\w.*?>/g.exec(t);if(null!=s){for(e=s[0].replace(/</g,"").replace(/\/?>/g,""),n=i[e]||i._default,t=n[1]+t+n[2],r.innerHTML=t,o=n[0];o--;)r=r.lastChild;return r.childNodes}return null},t.hasClass=function(t,e){return t.classList.contains(e)},t.addClass=function(t,e){for(var n=e.split(" "),o=0,i=n.length;i>o;o++)t.classList.add(n[o])},t.removeClass=function(t,e){for(var n=e.split(" "),o=0,i=n.length;i>o;o++)t.classList.remove(n[o])},t.toggleClass=function(t,e,n){var o=e.split(" "),i=0,r=o.length;if(void 0===n)for(;r>i;i++)t.classList.toggle(o[i]);else for(;r>i;i++)t.classList.toggle(o[i],n)},t.addListener=function(e,n,o,i){return void 0===i&&(i="type"in t.bubbleEvents?t.bubbleEvents[n]:!1),e.addEventListener(n,o,i)},t.removeListener=function(e,n,o,i){return void 0===i&&(i="type"in t.bubbleEvents?t.bubbleEvents[n]:!1),e.removeEventListener(n,o,i)},t.triggerEvent=function(t,e,n,o,i){var r=new CustomEvent(e,{detail:n,bubbles:o!==!1,cancelable:i!==!1});return t.dispatchEvent(r)},t.text=function(t,e){return void 0!==e&&(t.innerHTML=e),t.innerHTML},t.val=function(t,e){return void 0!==e&&(t.value=e),t.value},t.attr=function(n,o,i){if(e.Var.is(o,"object"))e.Object.each(o,function(e,o){t.attr(n,e,o)},this);else switch(o){case"class":this.addClass(n,i);break;case"text":this.text(n,i);break;default:if(null!==i)return void 0!==i&&n.setAttribute(o,i),n.getAttribute(o);n.removeAttribute(o)}},t.css=function(t,e,n,o){var i,r;return i=this.camel(e),void 0!==n&&(t.style[i]=n),r=o===!0?t.style:window.getComputedStyle(t),r.getPropertyValue(e)},t.data=function(t,e,n){return e=this.camel(e),null===n?delete t.dataset[e]:void 0!==n&&(t.dataset[e]=n),t.dataset[e]},t.append=function(t,n){e.Var.is(n,"array")||(n=[n]),e.Array.each(n,function(e,n){t.appendChild(n)},this)},t.empty=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},t.remove=function(t){t.parentElement&&t.parentElement.removeChild(t)},t.is=function(t,e){return t.matches&&t.matches(e)},t.prototype.add=function(t){if("length"in t)for(var e=0;t.length>e;e++)this.elements.push(t[e]);else this.elements.push(t)},t.prototype.count=function(){return this.elements.length},t.prototype.get=function(t){return this.elements[t]},t.prototype.filter=function(e){var n=[];return this.each(function(o,i){t.is(i,e)&&n.push(i)},this),this.elements=n,this},t.prototype.index=function(e){var n=-1;return this.each(function(o,i){return t.is(i,e)?(n=o,!1):void 0},this),n},t.prototype.child=function(e){var n,o=new t;return this.each(function(i,r){return(n=t.selectElement.call(this,e,r))?(o.add(n),!1):void 0},this),o},t.prototype.children=function(e){var n=new t;return this.each(function(o,i){n.add(t.selectElements.call(this,e,i))},this),n},t.prototype.parents=function(e){var n=new t;return this.each(function(t,e){n.add(e.parentElement)},this),e&&n.filter(e),n},t.prototype.each=function(t,n){n=n||this,e.Array.each(this.elements,t,n)},t.prototype.hasClass=function(e){var n;return this.each(function(o,i){return n=t.hasClass(i,e),!n},this),n},t.prototype.addClass=function(e){return this.each(function(n,o){t.addClass(o,e)},this),this},t.prototype.removeClass=function(e){return this.each(function(n,o){t.removeClass(o,e)},this),this},t.prototype.toggleClass=function(e,n){return this.each(function(o,i){t.toggleClass(i,e,n)},this),this},t.prototype.addListener=function(e,n,o){return this.each(function(i,r){t.addListener(r,e,n,o)},this),this},t.prototype.addDelegate=function(e,n,o,i,r){return i=i||this,this.addListener(n,function(n){for(var r,s=n.target;s;){if(t.is(s,e)){r=s;break}s=s.parentNode}r&&o.call(i,n,r)},r)},t.prototype.removeListener=function(e,n,o){return this.each(function(i,r){t.removeListener(r,e,n,o)},this),this},t.prototype.triggerEvent=function(e,n,o,i){var r=!0;return this.each(function(s,a){r=t.triggerEvent(a,e,n,o,i)&&r},this),r},t.prototype.text=function(e){return void 0===e?t.text(this.get(0)):(this.each(function(n,o){t.text(o,e)},this),void 0)},t.prototype.val=function(e){return void 0!==e?(this.each(function(n,o){t.val(o,e)},this),this):t.val(this.get(0))},t.prototype.attr=function(n,o){return void 0!==o||e.Var.is(n,"object")?(this.each(function(e,i){t.attr(i,n,o)},this),this):t.attr(this.get(0),n)},t.prototype.css=function(e,n,o){return void 0!==n?(this.each(function(i,r){t.css(r,e,n,o)},this),this):t.css(this.get(0),e,n,o)},t.prototype.data=function(e,n){return void 0!==n?(this.each(function(o,i){t.data(i,e,n)},this),this):t.data(this.get(0),e)},t.prototype.append=function(e){return e instanceof t&&(e=e.elements),t.append(this.get(0),e),this},t.prototype.appendTo=function(e){return e instanceof t||(e=new t(e)),e=e.get(0),this.each(function(n,o){t.append(e,o)},this),this},t.prototype.empty=function(){return this.each(function(e,n){t.empty(n)},this),this},t.prototype.show=function(){return this.each(function(){this.css("display","")},this),this},t.prototype.hide=function(){return this.each(function(){this.css("display","none")},this),this},t.prototype.remove=function(){return this.triggerEvent("beforeremove")!==!1&&this.each(function(e,n){var o=n.parentElement;t.remove(n),t.triggerEvent(o,"childremoved",{child:n})},this),this},t.prototype.is=function(e){var n;return this.each(function(o,i){return n=t.is(i,e)},this),n},t}(),e.Draggable=function(){function t(t){this.configs=this.getConfigs(t),this.configs.container=this.configs.container||new e.Dom("body"),this.onMouseDown=e.Function.proxy(this.onMouseDown,this),this.onMouseMove=e.Function.proxy(this.onMouseMove,this),this.onMouseUp=e.Function.proxy(this.onMouseUp,this),this.configs.handle.addListener("mousedown",this.onMouseDown),this.enable()}return t.defaults={limits:{top:null,left:null}},e.Class.extend(t),t.prototype.onMouseDown=function(t){this.enabled&&(this.start_state={left:parseInt(this.configs.target.css("left"),10)-t.clientX,top:parseInt(this.configs.target.css("top"),10)-t.clientY},this.configs.container.addListener("mouseup",this.onMouseUp).addListener("mousemove",this.onMouseMove),this.configs.target.addClass("dragging").triggerEvent("dragstart",null,!1,!0),t.stopPropagation())},t.prototype.onMouseMove=function(t){var e=t.clientX+this.start_state.left,n=t.clientY+this.start_state.top;isNaN(this.configs.limits.top)||(n=Math.max(n,this.configs.limits.top)),isNaN(this.configs.limits.left)||(e=Math.max(e,this.configs.limits.left)),this.configs.target.css("left",e+"px").css("top",n+"px").triggerEvent("drag",null,!1,!0),t.stopPropagation()},t.prototype.onMouseUp=function(t){this.configs.container.removeListener("mousemove",this.onMouseMove).removeListener("mouseup",this.onMouseUp),this.configs.target.removeClass("dragging").triggerEvent("dragend",null,!1,!0),t.stopPropagation()},t.prototype.enable=function(){return this.configs.target.addClass("draggable"),this.configs.handle.addClass("drag-handle"),this.enabled=!0,this},t.prototype.disable=function(){return this.configs.target.removeClass("draggable"),this.configs.handle.removeClass("drag-handle"),this.enabled=!1,this},t.prototype.destroy=function(){return this.disable(),this.configs.handle.removeListener("mousedown",this.onMouseDown),this},t}(),e.Function=function(){function t(){}return e.Class.extend(t),t.proxy=function(t,n,o){return e.Var.type(t,"function")?function(){return t.apply(n||this,o||arguments)}:void 0},t.emptyFn=function(){},t}(),e.Object=function(){function t(){}return e.Class.extend(t),t.extend=function(){for(var t,e,n,o,i=arguments[0]||{},r=1,s=arguments.length;s>r;r++)if(null!=(t=arguments[r]))for(e in t)n=i[e],o=t[e],n!==o&&void 0!==o&&(i[e]=o);return i},t.copy=function(e){return t.extend({},e)},t.each=function(t,e,n){var o,i,r=void 0!==n;for(o in t)if(i=e.call(r?n:t[o],o,t[o]),i===!1)break;return t},t}(),e.Resizable=function(){function t(t){this.configs=this.getConfigs(t),this.configs.container=this.configs.container||new e.Dom("body"),this.handles={},this.onMouseDown=e.Function.proxy(this.onMouseDown,this),this.onMouseMove=e.Function.proxy(this.onMouseMove,this),this.onMouseUp=e.Function.proxy(this.onMouseUp,this),e.Array.each(this.configs.directions,function(t,n){this.handles[n]=new e.Dom("<div/>",{"class":"resize-handle"}).data("direction",n).addListener("mousedown",this.onMouseDown).appendTo(this.configs.target)},this),this.enable()}return t.defaults={directions:["top","right","bottom","left","top-left","top-right","bottom-left","bottom-right"]},e.Class.extend(t),t.prototype.onMouseDown=function(t){this.enabled&&(this.start_state={handle:t.target,x:t.clientX,y:t.clientY,left:parseInt(this.configs.target.css("left"),10),top:parseInt(this.configs.target.css("top"),10),w:parseInt(this.configs.target.css("width"),10),h:parseInt(this.configs.target.css("height"),10)},this.configs.container.addListener("mousemove",this.onMouseMove,this).addListener("mouseup",this.onMouseUp,this),this.configs.target.addClass("resizing").triggerEvent("resizestart",null,!1,!0),t.stopPropagation())},t.prototype.onMouseMove=function(t){var n,o,i,r,s=new e.Dom(this.start_state.handle);switch(s.data("direction")){case"top":o=this.start_state.h-t.clientY+this.start_state.y,i=this.start_state.top+t.clientY-this.start_state.y;break;case"right":n=this.start_state.w+t.clientX-this.start_state.x;break;case"bottom":o=this.start_state.h+t.clientY-this.start_state.y;break;case"left":n=this.start_state.w-t.clientX+this.start_state.x,r=this.start_state.left+t.clientX-this.start_state.x;break;case"top-left":n=this.start_state.w-t.clientX+this.start_state.x,o=this.start_state.h-t.clientY+this.start_state.y,i=this.start_state.top+t.clientY-this.start_state.y,r=this.start_state.left+t.clientX-this.start_state.x;break;case"top-right":n=this.start_state.w+t.clientX-this.start_state.x,o=this.start_state.h-t.clientY+this.start_state.y,i=this.start_state.top+t.clientY-this.start_state.y;break;case"bottom-left":n=this.start_state.w-t.clientX+this.start_state.x,o=this.start_state.h+t.clientY-this.start_state.y,r=this.start_state.left+t.clientX-this.start_state.x;break;case"bottom-right":n=this.start_state.w+t.clientX-this.start_state.x,o=this.start_state.h+t.clientY-this.start_state.y}void 0!==i&&this.configs.target.css("top",i+"px"),void 0!==r&&this.configs.target.css("left",r+"px"),this.configs.target.css("width",n+"px").css("height",o+"px").triggerEvent("resize",null,!1,!0),t.stopPropagation()},t.prototype.onMouseUp=function(t){this.configs.container.removeListener("mousemove",this.onMouseMove,this).removeListener("mouseup",this.onMouseUp,this),this.configs.target.removeClass("resizing").triggerEvent("resizeend",null,!1,!0),t.stopPropagation()},t.prototype.enable=function(){return this.configs.target.addClass("resizable"),this.enabled=!0,this},t.prototype.disable=function(){return this.configs.target.removeClass("resizable"),this.enabled=!1,this},t.prototype.destroy=function(){return this.disable(),e.Object.each(this.handles,function(t,e){e.remove()},this),this},t}(),e.String=function(){function t(){}return e.Class.extend(t),t.capitalize=function(t){return t.replace(/(?:^|\s)\S/g,function(t){return t.toUpperCase()})},t.uuid=function(t,e){var n,o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],i=[];if(e=e||o.length,t)for(n=0;t>n;n++)i[n]=o[0|Math.random()*e];else{var r;for(i[8]=i[13]=i[18]=i[23]="-",i[14]="4",n=0;36>n;n++)i[n]||(r=0|16*Math.random(),i[n]=o[19===n?8|3&r:r])}return i.join("")},t.pad=function(t,e,n,o){var i,r,s;if(e===void 0&&(e=0),n===void 0&&(n=" "),o===void 0&&(o="right"),t+="",e+1>=t.length)switch(o){case"left":t=Array(e+1-t.length).join(n)+t;break;case"both":s=e-t.length,i=Math.ceil(s/2),r=s-i,t=Array(r+1).join(n)+t+Array(i+1).join(n);break;default:t+=Array(e+1-t.length).join(n)}return t},t}(),e.StyleSheet=function(){function t(t){this.configs=this.getConfigs(t),e.Dom.call(this,"<style/>",{type:"text/css"}),this.el=this.get(0),this.sheet=this.el.sheet,this.setInternalValue("")}return e.Dom.extend(t),t.prototype.addRule=function(t,e,n){return void 0===n&&(n=this.sheet.cssRules.length),"insertRule"in this.sheet?this.sheet.insertRule(t+"{"+e+"}",n):"addRule"in this.sheet?this.sheet.addRule(t,e,n):void 0},t.prototype.removeRule=function(t){return"deleteRule"in this.sheet?this.sheet.deleteRule(t):"removeRule"in this.sheet&&this.sheet.removeRule(t),this},t.prototype.removeRulesBySelector=function(t){var e=this.sheet.cssRules||this.sheet.rules;t=t.toLowerCase();for(var n=0;e.length>n;n++)if(e[n].selectorText.toLowerCase()===t){this.removeRule(n);break}return this},t.prototype.removeRules=function(){for(var t=this.sheet.cssRules||this.sheet.rules;t.length>0;)this.removeRule(0);return this},t.prototype.setInternalValue=function(t){return this.el.styleSheet?this.el.styleSheet.cssText=t:this.text(t),this},t}(),e.Var=function(){function t(){}var n={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"};return e.Class.extend(t),t.type=function(t){return null==t?t+"":n[Object.prototype.toString.call(t)]||"object"},t.is=function(e,n){return t.type(e)===n.toLowerCase()},t.isEmpty=function(t){return void 0===t||null==t?!0:t.hasOwnProperty("length")?0>=t.length:e.Var.is(t,"object")?0>=Object.keys(t).length:!1},t}(),e.Locale=function(){function t(){}return e.Class.extend(t),t.strings={},t.t=function(n,o,i){var r=e.getLocale();return this.strings.hasOwnProperty(r)&&this.strings[r].hasOwnProperty(n)&&(o=this.strings[r][n]),t.formatString(o,i)},t.formatString=function(t,n){return e.Object.each(n,function(e){t=t.replace(e,n[e])},this),t},t}(),e.Locale.strings.fr=e.Object.extend(e.Locale.strings.fr,{}),e.Locale.strings.fr=e.Object.extend(e.Locale.strings.fr,{"player.Pager.count":"page !current/!count","player.component.Block.name":"Name","player.component.Block.x":"X","player.component.Block.y":"Y","player.component.Block.width":"Width","player.component.Block.height":"Height","player.component.Block.background-color":"Background color","player.component.Block.background-image":"Background image","player.component.Block.border-width":"Border width","player.component.Block.border-color":"Border color","player.component.Block.synched":"Synchronized pages ?","player.component.Controller.x":"X","player.component.Controller.y":"Y","player.component.Element.name":"Name","player.component.Element.x":"X","player.component.Element.y":"Y","player.component.Element.width":"Width","player.component.Element.height":"Height","player.component.Element.r-index":"Reading index","player.component.Element.z-index":"Display index","player.component.Element.background-color":"Background color","player.component.Element.background-image":"Background image","player.component.Element.border-width":"Border width","player.component.Element.border-color":"Border color","player.component.Element.border-radius":"Border radius","player.component.Element.opacity":"Opacity","player.component.Element.start-time":"Start time","player.component.Element.end-time":"End time","player.component.Media.x":"X","player.component.Media.y":"Y","player.component.Media.width":"Width","player.component.Media.height":"Height","player.component.Page.background-color":"Background color","player.component.Page.background-image":"Background image","player.component.Page.start-time":"Start time","player.component.Page.end-time":"End time","player.component.element.Cursor.direction":"Direction","player.component.element.Cursor.direction.right":"Left > Right","player.component.element.Cursor.direction.left":"Right > Left","player.component.element.Cursor.direction.bottom":"Top > Bottom","player.component.element.Cursor.direction.top":"Bottom > Top","player.component.element.Cursor.acceleration":"Acceleration","player.component.element.Cursor.cursor-width":"Cursor width","player.component.element.Cursor.cursor-color":"Cursor color"}),e.Player=function(){function t(n){var o,i;this.configs=this.getConfigs(n),o=new e.Dom("<iframe></iframe>",{"class":"metaScore-player"}).css("width",this.configs.width).css("height",this.configs.height).css("border","none").appendTo(this.configs.container),i=o.get(0).contentDocument,t.parent.call(this,i.body),this.configs.keyboard&&this.addListener("keydown",e.Function.proxy(this.onKeydown,this)),this.iframe=o,this.head=new e.Dom(i.head),this.load()}return t.defaults={url:"",width:"100%",height:"100%",container:"body",ajax:{},keyboard:!0},e.Dom.extend(t),t.prototype.onKeydown=function(t){switch(t.keyCode){case 32:this.media.isPlaying()?this.media.pause():this.media.play(),t.preventDefault();break;case 37:this.child('.metaScore-component.block:hover .pager .button[data-action="previous"]').triggerEvent("click"),t.preventDefault();break;case 39:this.child('.metaScore-component.block:hover .pager .button[data-action="next"]').triggerEvent("click"),t.preventDefault()}},t.prototype.onControllerButtonClick=function(t){var n=e.Dom.data(t.target,"action");switch(n){case"rewind":this.media.reset();break;case"play":this.media.isPlaying()?this.media.pause():this.media.play()}t.stopPropagation()},t.prototype.onMediaPlay=function(){this.controller.addClass("playing")},t.prototype.onMediaPause=function(){this.controller.removeClass("playing")},t.prototype.onMediaTimeUpdate=function(t){var e=t.detail.media.getTime();this.controller.updateTime(e)},t.prototype.onPageActivate=function(t){var e=t.target._metaScore,n=t.detail.page;e.getProperty("synched")&&this.media.setTime(n.getProperty("start-time"))},t.prototype.onElementTime=function(t){this.linkcuepoint&&this.linkcuepoint.destroy(),this.media.setTime(t.detail.value),t.detail.forcePlay&&this.media.play(),t.detail.stop&&(this.linkcuepoint=new e.player.CuePoint({media:this.media,inTime:t.detail.stop,onStart:e.Function.proxy(this.onLinkCuePointStart,this)}))},t.prototype.onLinkCuePointStart=function(t){t.destroy(),this.setReadingIndex(0),this.media.pause()},t.prototype.onElementReadingIndex=function(t){this.setReadingIndex(t.detail.value),t.stopPropagation()},t.prototype.onComponenetPropChange=function(t){var e=t.detail.component;switch(t.detail.property){case"start-time":case"end-time":e.setCuePoint({media:this.media})}},t.prototype.load=function(){var t;this.addClass("loading"),t=e.Object.extend({},{success:e.Function.proxy(this.onLoadSuccess,this),error:e.Function.proxy(this.onLoadError,this)},this.configs.ajax),e.Ajax.get(this.configs.url,t)},t.prototype.onLoadSuccess=function(t){this.json=JSON.parse(t.response),this.data("id",this.json.id),this.json.base_url&&new e.Dom("<base/>",{href:this.json.base_url,target:"_blank"}).appendTo(this.getHead()),new e.Dom("<link/>",{rel:"stylesheet",type:"text/css",href:this.json.library_css}).appendTo(this.getHead()),this.css=(new e.StyleSheet).setInternalValue(this.json.css).appendTo(this.getHead()),this.rindex_css=(new e.StyleSheet).appendTo(this.getHead()),this.media=new e.player.component.Media(this.json.media).addListener("play",e.Function.proxy(this.onMediaPlay,this)).addListener("pause",e.Function.proxy(this.onMediaPause,this)).addListener("timeupdate",e.Function.proxy(this.onMediaTimeUpdate,this)).appendTo(this),this.controller=new e.player.component.Controller(this.json.controller).addDelegate(".buttons button","click",e.Function.proxy(this.onControllerButtonClick,this)).appendTo(this),e.Array.each(this.json.blocks,function(t,e){this.addBlock(e)},this),this.media.reset(),this.removeClass("loading"),this.triggerEvent("loadsuccess",{player:this,data:this.json},!0,!1)},t.prototype.onLoadError=function(){this.removeClass("loading"),this.triggerEvent("loaderror",{player:this},!0,!1)},t.prototype.getId=function(){return this.data("id")},t.prototype.getHead=function(){return this.head},t.prototype.getIFrame=function(){return this.iframe},t.prototype.getData=function(){return this.json},t.prototype.getComponents=function(t){var e=".metaScore-component";return t&&(e+="."+t),this.children(e)},t.prototype.addBlock=function(t,n){var o;return o=t instanceof e.player.component.Block?t:new e.player.component.Block(e.Object.extend({},t,{container:this,listeners:{propchange:e.Function.proxy(this.onComponenetPropChange,this)}})).addListener("pageactivate",e.Function.proxy(this.onPageActivate,this)).addDelegate(".element","time",e.Function.proxy(this.onElementTime,this)).addDelegate(".element","rindex",e.Function.proxy(this.onElementReadingIndex,this)),n===!0&&this.triggerEvent("blockadd",{player:this,block:o},!0,!1),o},t.prototype.updateCSS=function(t){this.css.setInternalValue(t)},t.prototype.setReadingIndex=function(t,e){this.rindex_css.removeRules(),0!==t&&(this.rindex_css.addRule('.metaScore-component.element[data-r-index="'+t+'"]:not([data-start-time]) .contents',"display: block;"),this.rindex_css.addRule('.metaScore-component.element[data-r-index="'+t+'"].active .contents',"display: block;")),e!==!0&&this.triggerEvent("rindex",{player:this,value:t},!0,!1)},t.prototype.remove=function(){this.getIFrame().remove()},t}(),e.namespace("player").Component=function(){function t(n){this.configs=this.getConfigs(n),t.parent.call(this,"<div/>",{"class":"metaScore-component"}),this.get(0)._metaScore=this,this.configs.container&&this.appendTo(this.configs.container),e.Object.each(this.configs.listeners,function(t,e){this.addListener(t,e)},this),this.setupDOM(),e.Object.each(this.configs,function(t,e){this.setProperty(t,e)},this)}return e.Dom.extend(t),t.defaults={properties:{}},t.prototype.setupDOM=function(){},t.prototype.getProperty=function(t){return t in this.configs.properties&&"getter"in this.configs.properties[t]?this.configs.properties[t].getter.call(this):void 0},t.prototype.getProperties=function(t){var n,o={};return e.Object.each(this.configs.properties,function(e,i){"getter"in i&&(n=i.getter.call(this,t),null!==n&&(o[e]=n))},this),o},t.prototype.setProperty=function(t,e){t in this.configs.properties&&"setter"in this.configs.properties[t]&&(this.configs.properties[t].setter.call(this,e),this.triggerEvent("propchange",{component:this,property:t,value:e}))},t.prototype.setCuePoint=function(t){var n=this.getProperty("start-time"),o=this.getProperty("end-time");return this.cuepoint&&this.cuepoint.destroy(),(null!=n||null!=o)&&(this.cuepoint=new e.player.CuePoint(e.Object.extend({},t,{inTime:n,outTime:o-1,onStart:this.onCuePointStart?e.Function.proxy(this.onCuePointStart,this):null,onUpdate:this.onCuePointUpdate?e.Function.proxy(this.onCuePointUpdate,this):null,onEnd:this.onCuePointEnd?e.Function.proxy(this.onCuePointEnd,this):null}))),this.cuepoint},t}(),e.namespace("player").CuePoint=function(){function t(t){this.configs=this.getConfigs(t),this.id=e.String.uuid(),this.running=!1,this.inTimer=null,this.outTimer=null,this.launch=e.Function.proxy(this.launch,this),this.stop=e.Function.proxy(this.stop,this),this.onMediaTimeUpdate=e.Function.proxy(this.onMediaTimeUpdate,this),this.configs.media.addListener("timeupdate",this.onMediaTimeUpdate)}return e.Evented.extend(t),t.defaults={media:null,inTime:null,outTime:null,onStart:null,onUpdate:null,onEnd:null},t.prototype.onMediaTimeUpdate=function(){var t=this.configs.media.getTime();this.running?(!this.outTimer&&null!==this.configs.outTime&&t>=this.configs.outTime-.5&&(this.outTimer=setTimeout(this.stop,Math.max(0,this.configs.outTime-t))),e.Var.is(this.configs.onUpdate,"function")&&this.configs.onUpdate(this,t)):!this.inTimer&&t>=this.configs.inTime-.5&&(null===this.configs.outTime||this.configs.outTime>=t)&&(this.inTimer=setTimeout(this.launch,Math.max(0,this.configs.inTime-t)))},t.prototype.launch=function(){this.running||(this.inTimer&&(clearTimeout(this.inTimer),this.inTimer=null),e.Var.is(this.configs.onStart,"function")&&this.configs.onStart(this),null===this.configs.outTime||!this.configs.onUpdate&&!this.configs.onEnd?this.stop():this.running=!0)},t.prototype.stop=function(t){this.inTimer&&(clearTimeout(this.inTimer),this.inTimer=null),this.outTimer&&(clearTimeout(this.outTimer),this.outTimer=null),t!==!1&&e.Var.is(this.configs.onEnd,"function")&&this.configs.onEnd(this),this.running=!1},t.prototype.destroy=function(){this.stop(!1),this.configs.media.removeListener("timeupdate",this.onMediaTimeUpdate)},t}(),e.namespace("player").Pager=function(){function t(n){this.configs=this.getConfigs(n),t.parent.call(this,"<div/>",{"class":"pager"}),this.count=new e.Dom("<div/>",{"class":"count"}).appendTo(this),this.buttons=new e.Dom("<div/>",{"class":"buttons"}).addListener("mousedown",function(t){t.stopPropagation()}).appendTo(this),this.buttons.first=new e.Dom("<div/>",{"class":"button","data-action":"first"}).appendTo(this.buttons),this.buttons.previous=new e.Dom("<div/>",{"class":"button","data-action":"previous"}).appendTo(this.buttons),this.buttons.next=new e.Dom("<div/>",{"class":"button","data-action":"next"}).appendTo(this.buttons)}return e.Dom.extend(t),t.prototype.updateCount=function(t,n){this.count.text(e.Locale.t("player.Pager.count","page !current/!count",{"!current":t+1,"!count":n})),this.buttons.first.toggleClass("inactive",0===t),this.buttons.previous.toggleClass("inactive",0===t),this.buttons.next.toggleClass("inactive",t>=n-1)
},t}(),e.namespace("player.component").Block=function(){function t(e){t.parent.call(this,e)}return e.player.Component.extend(t),t.defaults={container:null,properties:{name:{type:"Text",label:e.Locale.t("player.component.Block.name","Name"),getter:function(){return this.data("name")},setter:function(t){this.data("name",t)}},x:{type:"Number",label:e.Locale.t("player.component.Block.x","X"),getter:function(){return parseInt(this.css("left"),10)},setter:function(t){this.css("left",t+"px")}},y:{type:"Number",label:e.Locale.t("player.component.Block.y","Y"),getter:function(){return parseInt(this.css("top"),10)},setter:function(t){this.css("top",t+"px")}},width:{type:"Number",label:e.Locale.t("player.component.Block.width","Width"),getter:function(){return parseInt(this.css("width"),10)},setter:function(t){this.css("width",t+"px")}},height:{type:"Number",label:e.Locale.t("player.component.Block.height","Height"),getter:function(){return parseInt(this.css("height"),10)},setter:function(t){this.css("height",t+"px")}},"background-color":{type:"Color",label:e.Locale.t("player.component.Block.background-color","Background color"),getter:function(t){return this.css("background-color",void 0,t)},setter:function(t){var n=e.Color.parse(t);this.css("background-color","rgba("+n.r+","+n.g+","+n.b+","+n.a+")")}},"background-image":{type:"Image",label:e.Locale.t("player.component.Block.background-image","Background image"),getter:function(t){var n=this.css("background-image",void 0,t);return"none"!==n&&e.Var.is(n,"string")?n.replace(/^url\(["']?/,"").replace(/["']?\)$/,""):null},setter:function(t){t="none"!==t&&e.Var.is(t,"string")&&t.length>0?"url("+t+")":null,this.css("background-image",t)}},"border-width":{type:"Number",label:e.Locale.t("player.component.Block.border-width","Border width"),getter:function(t){var e=this.css("border-width",void 0,t);return null!==e?parseInt(e,10):null},setter:function(t){this.css("border-width",t+"px")}},"border-color":{type:"Color",label:e.Locale.t("player.component.Block.border-color","Border color"),getter:function(t){return this.css("border-color",void 0,t)},setter:function(t){var n=e.Color.parse(t);this.css("border-color","rgba("+n.r+","+n.g+","+n.b+","+n.a+")")}},synched:{type:"Boolean",label:e.Locale.t("player.component.Block.synched","Synchronized pages ?"),getter:function(){return"true"===this.data("synched")},setter:function(t){this.data("synched",t)}},pages:{editable:!1,getter:function(t){var e=[];return this.getPages().each(function(n,o){e.push(o._metaScore.getProperties(t))},this),e},setter:function(t){this.getPages().remove(),e.Array.each(t,function(t,e){this.addPage(e)},this),this.setActivePage(0)}}}},t.prototype.setupDOM=function(){t.parent.prototype.setupDOM.call(this),this.addClass("block"),this.pages=new e.Dom("<div/>",{"class":"pages"}).addDelegate(".page","cuepointstart",e.Function.proxy(this.onPageCuePointStart,this)).addDelegate(".element","page",e.Function.proxy(this.onElementPage,this)).appendTo(this),this.pager=(new e.player.Pager).addDelegate(".button","click",e.Function.proxy(this.onPagerClick,this)).appendTo(this),this.addPage()},t.prototype.onPageCuePointStart=function(t){this.setActivePage(t.target._metaScore,!0)},t.prototype.onElementPage=function(t){this.setActivePage(t.detail.value)},t.prototype.onPagerClick=function(t){var n,o=!e.Dom.hasClass(t.target,"inactive");if(o)switch(n=e.Dom.data(t.target,"action")){case"first":this.setActivePage(0);break;case"previous":this.setActivePage(this.getActivePageIndex()-1);break;case"next":this.setActivePage(this.getActivePageIndex()+1)}t.stopPropagation()},t.prototype.getPages=function(){return this.pages.children(".page")},t.prototype.addPage=function(t){var n;return t instanceof e.player.component.Page?(n=t,n.appendTo(this.pages)):n=new e.player.component.Page(e.Object.extend({},t,{container:this.pages})),this.setActivePage(n),n},t.prototype.removePage=function(t){var e;return t.remove(),0>=this.getPageCount()?this.addPage():t.hasClass("active")&&(e=Math.max(0,this.getActivePageIndex()-1),this.setActivePage(e)),t},t.prototype.getActivePage=function(){var t=(this.getPages(),this.getActivePageIndex());return 0>t?null:this.getPages().get(t)._metaScore},t.prototype.getActivePageIndex=function(){var t=this.getPages(),e=t.index(".active");return e},t.prototype.getPageCount=function(){return this.getPages().count()},t.prototype.setActivePage=function(t,n){var o=this.getPages();t instanceof e.player.component.Page||(t=o.get(parseInt(t,10))._metaScore),t&&(o.removeClass("active"),t.addClass("active"),this.updatePager(),n!==!0&&this.triggerEvent("pageactivate",{page:t}))},t.prototype.updatePager=function(){var t=this.getActivePageIndex(),e=this.getPageCount();this.pager.updateCount(t,e),this.data("page-count",e)},t}(),e.namespace("player.component").Controller=function(){function t(e){t.parent.call(this,e)}return e.player.Component.extend(t),t.defaults={properties:{x:{type:"Number",label:e.Locale.t("player.component.Controller.x","X"),getter:function(){return parseInt(this.css("left"),10)},setter:function(t){this.css("left",t+"px")}},y:{type:"Number",label:e.Locale.t("player.component.Controller.y","Y"),getter:function(){return parseInt(this.css("top"),10)},setter:function(t){this.css("top",t+"px")}}}},t.prototype.setupDOM=function(){t.parent.prototype.setupDOM.call(this),this.addClass("controller"),this.timer=new e.Dom("<div/>",{"class":"timer",text:"00:00:00.00"}).appendTo(this),this.rewind_btn=new e.Dom("<button/>").data("action","rewind"),this.play_btn=new e.Dom("<button/>").data("action","play"),new e.Dom("<div/>",{"class":"buttons"}).append(this.rewind_btn).append(this.play_btn).appendTo(this)},t.prototype.updateTime=function(t){var n=e.String.pad(parseInt(t/10%100,10),2,"0","left"),o=e.String.pad(parseInt(t/1e3%60,10),2,"0","left"),i=e.String.pad(parseInt(t/6e4,10),2,"0","left");this.timer.text(i+":"+o+"."+n)},t}(),e.namespace("player.component").Element=function(){function t(e){t.parent.call(this,e)}return e.player.Component.extend(t),t.defaults={properties:{name:{type:"Text",label:e.Locale.t("player.component.Element.name","Name"),getter:function(){return this.data("name")},setter:function(t){this.data("name",t)}},type:{editable:!1,getter:function(){return this.data("type")},setter:function(t){this.data("type",t)}},x:{type:"Number",label:e.Locale.t("player.component.Element.x","X"),getter:function(){return parseInt(this.css("left"),10)},setter:function(t){this.css("left",t+"px")}},y:{type:"Number",label:e.Locale.t("player.component.Element.y","Y"),getter:function(){return parseInt(this.css("top"),10)},setter:function(t){this.css("top",t+"px")}},width:{type:"Number",label:e.Locale.t("player.component.Element.width","Width"),getter:function(){return parseInt(this.css("width"),10)},setter:function(t){this.css("width",t+"px")}},height:{type:"Number",label:e.Locale.t("player.component.Element.height","Height"),getter:function(){return parseInt(this.css("height"),10)},setter:function(t){this.css("height",t+"px")}},"r-index":{type:"Number",label:e.Locale.t("player.component.Element.r-index","Reading index"),configs:{min:0},getter:function(){var t=this.data("r-index");return null!==t?parseInt(t,10):null},setter:function(t){this.data("r-index",t)}},"z-index":{type:"Number",label:e.Locale.t("player.component.Element.z-index","Display index"),getter:function(t){var e=this.css("z-index",void 0,t);return null!==e?parseInt(e,10):null},setter:function(t){this.css("z-index",t)}},"background-color":{type:"Color",label:e.Locale.t("player.component.Element.background-color","Background color"),getter:function(t){return this.contents.css("background-color",void 0,t)},setter:function(t){var n=e.Color.parse(t);this.contents.css("background-color","rgba("+n.r+","+n.g+","+n.b+","+n.a+")")}},"background-image":{type:"Image",label:e.Locale.t("player.component.Element.background-image","Background image"),getter:function(t){var n=this.contents.css("background-image",void 0,t);return"none"!==n&&e.Var.is(n,"string")?n.replace(/^url\(["']?/,"").replace(/["']?\)$/,""):null},setter:function(t){t="none"!==t&&e.Var.is(t,"string")&&t.length>0?"url("+t+")":null,this.contents.css("background-image",t)}},"border-width":{type:"Number",label:e.Locale.t("player.component.Element.border-width","Border width"),getter:function(t){var e=this.contents.css("border-width",void 0,t);return null!==e?parseInt(e,10):null},setter:function(t){this.contents.css("border-width",t+"px")}},"border-color":{type:"Color",label:e.Locale.t("player.component.Element.border-color","Border color"),getter:function(t){return this.contents.css("border-color",void 0,t)},setter:function(t){var n=e.Color.parse(t);this.contents.css("border-color","rgba("+n.r+","+n.g+","+n.b+","+n.a+")")}},"border-radius":{type:"BorderRadius",label:e.Locale.t("player.component.Element.border-radius","Border radius"),getter:function(t){return this.contents.css("border-radius",void 0,t)},setter:function(t){this.contents.css("border-radius",t)}},opacity:{type:"Number",label:e.Locale.t("player.component.Element.opacity","Opacity"),configs:{min:0,max:1,step:.1},getter:function(t){return this.contents.css("opacity",void 0,t)},setter:function(t){this.contents.css("opacity",t)}},"start-time":{type:"Time",label:e.Locale.t("player.component.Element.start-time","Start time"),configs:{checkbox:!0,inButton:!0,outButton:!0},getter:function(){var t=parseFloat(this.data("start-time"));return isNaN(t)?null:t},setter:function(t){this.data("start-time",isNaN(t)?null:t)}},"end-time":{type:"Time",label:e.Locale.t("player.component.Element.end-time","End time"),configs:{checkbox:!0,inButton:!0,outButton:!0},getter:function(){var t=parseFloat(this.data("end-time"));return isNaN(t)?null:t},setter:function(t){this.data("end-time",isNaN(t)?null:t)}}}},t.prototype.setupDOM=function(){t.parent.prototype.setupDOM.call(this),this.addClass("element"),this.contents=new e.Dom("<div/>",{"class":"contents"}).appendTo(this)},t.prototype.onCuePointStart=function(){this.addClass("active")},t.prototype.onCuePointEnd=function(){this.removeClass("active")},t}(),e.namespace("player.component").Media=function(){function t(e){t.parent.call(this,e),this.playing=!1}return e.player.Component.extend(t),t.defaults={type:"audio",sources:[],useFrameAnimation:!0,properties:{x:{type:"Number",label:e.Locale.t("player.component.Media.x","X"),getter:function(){return parseInt(this.css("left"),10)},setter:function(t){this.css("left",t+"px")}},y:{type:"Number",label:e.Locale.t("player.component.Media.y","Y"),getter:function(){return parseInt(this.css("top"),10)},setter:function(t){this.css("top",t+"px")}},width:{type:"Number",label:e.Locale.t("player.component.Media.width","Width"),getter:function(){return parseInt(this.css("width"),10)},setter:function(t){this.css("width",t+"px")}},height:{type:"Number",label:e.Locale.t("player.component.Media.height","Height"),getter:function(){return parseInt(this.css("height"),10)},setter:function(t){this.css("height",t+"px")}}}},t.prototype.setupDOM=function(){var n="";t.parent.prototype.setupDOM.call(this),this.addClass("media "+this.configs.type),e.Array.each(this.configs.sources,function(t,e){n+='<source src="'+e.url+'" type="'+e.mime+'"></source>'}),this.el=new e.Dom("<"+this.configs.type+">"+n+"</"+this.configs.type+">",{preload:"auto"}).appendTo(this),this.dom=this.el.get(0),this.el.addListener("canplay",e.Function.proxy(this.onCanPlay,this)).addListener("play",e.Function.proxy(this.onPlay,this)).addListener("pause",e.Function.proxy(this.onPause,this)).addListener("timeupdate",e.Function.proxy(this.onTimeUpdate,this)).addListener("volumechange",e.Function.proxy(this.onVolumeChange,this)).addListener("ended",e.Function.proxy(this.onEnded,this)),this.configs.useFrameAnimation&&this.el.addListener("play",e.Function.proxy(this.triggerTimeUpdate,this))},t.prototype.onCanPlay=function(){this.triggerEvent("canplay")},t.prototype.onPlay=function(){this.playing=!0,this.triggerEvent("play")},t.prototype.onPause=function(){this.playing=!1,this.triggerEvent("pause")},t.prototype.onTimeUpdate=function(t){t instanceof CustomEvent||t.stopPropagation(),this.configs.useFrameAnimation||this.triggerTimeUpdate(!1)},t.prototype.onVolumeChange=function(){this.triggerEvent("volumechange")},t.prototype.onEnded=function(){this.triggerEvent("ended")},t.prototype.isPlaying=function(){return this.playing},t.prototype.reset=function(t){this.setTime(0),t!==!0&&this.triggerEvent("reset")},t.prototype.play=function(t){this.dom.play(),t!==!0&&this.triggerEvent("play")},t.prototype.pause=function(t){this.dom.pause(),t!==!0&&this.triggerEvent("pause")},t.prototype.stop=function(t){this.setTime(0),this.pause(!0),this.triggerTimeUpdate(!1),t!==!0&&this.triggerEvent("stop")},t.prototype.triggerTimeUpdate=function(t){t!==!1&&this.isPlaying()&&window.requestAnimationFrame(e.Function.proxy(this.triggerTimeUpdate,this)),this.triggerEvent("timeupdate",{media:this})},t.prototype.setTime=function(t){this.dom.currentTime=parseFloat(t)/1e3,this.triggerTimeUpdate(!1)},t.prototype.getTime=function(){return 1e3*parseFloat(this.dom.currentTime)},t.prototype.getDuration=function(){return 1e3*parseFloat(this.dom.duration)},t}(),e.namespace("player.component").Page=function(){function t(e){t.parent.call(this,e)}return e.player.Component.extend(t),t.defaults={properties:{"background-color":{type:"Color",label:e.Locale.t("player.component.Page.background-color","Background color"),getter:function(t){return this.css("background-color",void 0,t)},setter:function(t){var n=e.Color.parse(t);this.css("background-color","rgba("+n.r+","+n.g+","+n.b+","+n.a+")")}},"background-image":{type:"Image",label:e.Locale.t("player.component.Page.background-image","Background image"),getter:function(t){var n=this.css("background-image",void 0,t);return"none"!==n&&e.Var.is(n,"string")?n.replace(/^url\(["']?/,"").replace(/["']?\)$/,""):null},setter:function(t){t="none"!==t&&e.Var.is(t,"string")&&t.length>0?"url("+t+")":null,this.css("background-image",t)}},"start-time":{type:"Time",label:e.Locale.t("player.component.Page.start-time","Start time"),configs:{checkbox:!0,inButton:!0,outButton:!0},getter:function(){var t=parseFloat(this.data("start-time"));return isNaN(t)?null:t},setter:function(t){this.data("start-time",isNaN(t)?null:t)}},"end-time":{type:"Time",label:e.Locale.t("player.component.Page.end-time","End time"),configs:{checkbox:!0,inButton:!0,outButton:!0},getter:function(){var t=parseFloat(this.data("end-time"));return isNaN(t)?null:t},setter:function(t){this.data("end-time",isNaN(t)?null:t)}},elements:{editable:!1,getter:function(t){var e=[];return this.getElements().each(function(n,o){e.push(o._metaScore.getProperties(t))},this),e},setter:function(t){e.Array.each(t,function(t,e){this.addElement(e)},this)}}}},t.prototype.setupDOM=function(){t.parent.prototype.setupDOM.call(this),this.addClass("page")},t.prototype.addElement=function(t){var n;return t instanceof e.player.component.Element?(n=t,n.appendTo(this)):n=new e.player.component.element[t.type](e.Object.extend({},t,{container:this})),n},t.prototype.getElements=function(){return this.children(".element")},t.prototype.onCuePointStart=function(){this.triggerEvent("cuepointstart")},t.prototype.onCuePointEnd=function(){this.triggerEvent("cuepointend")},t}(),e.namespace("player.component.element").Cursor=function(){function t(e){t.parent.call(this,e)}return e.player.component.Element.extend(t),t.defaults={properties:e.Object.extend({},e.player.component.Element.defaults.properties,{direction:{type:"Select",label:e.Locale.t("player.component.element.Cursor.direction","Direction"),configs:{options:{right:e.Locale.t("player.component.element.Cursor.direction.right","Left > Right"),left:e.Locale.t("player.component.element.Cursor.direction.left","Right > Left"),bottom:e.Locale.t("player.component.element.Cursor.direction.bottom","Top > Bottom"),top:e.Locale.t("player.component.element.Cursor.direction.top","Bottom > Top")}},getter:function(){return this.data("direction")},setter:function(t){this.data("direction",t)}},acceleration:{type:"Number",label:e.Locale.t("player.component.element.Cursor.acceleration","Acceleration"),getter:function(){return this.data("accel")},setter:function(t){this.data("accel",t)}},"cursor-width":{type:"Number",label:e.Locale.t("player.component.element.Cursor.cursor-width","Cursor width"),getter:function(t){var e=this.cursor.css("width",void 0,t);return null!==e?parseInt(e,10):null},setter:function(t){this.cursor.css("width",t+"px")}},"cursor-color":{type:"Color",label:e.Locale.t("player.component.element.Cursor.cursor-color","Cursor color"),getter:function(t){return this.cursor.css("background-color",void 0,t)},setter:function(t){var n=e.Color.parse(t);this.cursor.css("background-color","rgba("+n.r+","+n.g+","+n.b+","+n.a+")")}}})},t.prototype.setupDOM=function(){t.parent.prototype.setupDOM.call(this),this.data("type","cursor"),this.cursor=new e.Dom("<div/>",{"class":"cursor"}).appendTo(this.contents),this.addListener("click",e.Function.proxy(this.onClick,this)).addListener("dblclick",e.Function.proxy(this.onClick,this))},t.prototype.onClick=function(t){var n,o,i,r,s,a,c;if(!e.editing||"dblclick"===t.type){switch(i=this.getProperty("start-time"),r=this.getProperty("end-time"),s=this.getProperty("direction"),a=this.getProperty("acceleration"),c=t.target.getBoundingClientRect(),s){case"left":n=(c.right-t.clientX)/this.getProperty("width");break;case"bottom":n=(t.clientY-c.top)/this.getProperty("height");break;case"top":n=(c.bottom-t.clientY)/this.getProperty("height");break;default:n=(t.clientX-c.left)/this.getProperty("width")}o=a&&1!==a?i+(r-i)*Math.pow(n,1/a):i+(r-i)*n,this.triggerEvent("time",{element:this,value:o})}},t.prototype.onCuePointUpdate=function(t,e){var n,o,i,r,s,a=this.getProperty("direction"),c=this.getProperty("acceleration");switch(i=this.getProperty("start-time"),r=this.getProperty("end-time"),s=c&&1!==c?Math.pow((e-i)/(r-i),c):(e-i)/(r-i),a){case"left":n=this.getProperty("width"),s=Math.min(n*s,n),this.cursor.css("right",s+"px");break;case"bottom":o=this.getProperty("height"),s=Math.min(o*s,o),this.cursor.css("top",s+"px");break;case"top":o=this.getProperty("height"),s=Math.min(o*s,o),this.cursor.css("bottom",s+"px");break;default:n=this.getProperty("width"),s=Math.min(n*s,n),this.cursor.css("left",s+"px")}},t}(),e.namespace("player.component.element").Image=function(){function t(e){t.parent.call(this,e)}return e.player.component.Element.extend(t),t.prototype.setupDOM=function(){t.parent.prototype.setupDOM.call(this),this.data("type","image")},t}(),e.namespace("player.component.element").Text=function(){function t(n){t.parent.call(this,n),this.addDelegate("a","click",e.Function.proxy(this.onLinkClick,this))}return e.player.component.Element.extend(t),t.defaults={properties:e.Object.extend({},e.player.component.Element.defaults.properties,{text:{editable:!1,getter:function(){return this.contents.text()},setter:function(t){this.contents.text(t)}}})},t.prototype.setupDOM=function(){t.parent.prototype.setupDOM.call(this),this.data("type","text")},t.prototype.onLinkClick=function(t){var e,n=t.target;(e=n.hash.match(/^#p=(\d+)/))?(this.triggerEvent("page",{element:this,value:parseInt(e[1])-1}),t.preventDefault()):(e=n.hash.match(/^#t=(\d*\.?\d+),(\d*\.?\d+)&r=(\d+)/))?(this.triggerEvent("time",{element:this,value:parseFloat(e[1]),stop:parseFloat(e[2]),forcePlay:!0}),this.triggerEvent("rindex",{element:this,value:parseInt(e[3])})):window.open(n.href,"_blank"),t.preventDefault()},t}()})(this);